<!DOCTYPE html>
<html>
<head>
  <title>Emergency Superadmin Fix</title>
  <style>
    body {
      font-family: system-ui;
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
    }
    button {
      background: #007bff;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    #result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 6px;
    }
    .success {
      background: #d4edda;
      color: #155724;
    }
    .error {
      background: #f8d7da;
      color: #721c24;
    }
  </style>
</head>
<body>
  <h1>Emergency Superadmin Fix</h1>
  <p>Click the button below to set your role to superadmin:</p>
  <button onclick="fixRole()">Fix My Role</button>
  <div id="result"></div>

  <script>
    async function fixRole() {
      const resultDiv = document.getElementById('result');
      resultDiv.textContent = 'Fixing role...';
      resultDiv.className = '';

      try {
        const response = await fetch('https://playbookd.crucibleanalytics.dev/api/emergency-superadmin', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            secret: 'temp-secret-12345',
            userEmail: 'llanes.joseph.m@gmail.com'
          })
        });

        const data = await response.json();

        if (response.ok) {
          resultDiv.textContent = `✅ Success! ${data.message}\n\nPlease refresh your browser to see the changes.`;
          resultDiv.className = 'success';
        } else {
          resultDiv.textContent = `❌ Error: ${data.error}`;
          resultDiv.className = 'error';
        }
      } catch (error) {
        resultDiv.textContent = `❌ Error: ${error.message}\n\nMake sure npm run dev is running!`;
        resultDiv.className = 'error';
      }
    }
  </script>
</body>
</html>
